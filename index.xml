<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>AGou's Blog-2</title><link>https://agou-ops.cn/myBlog-2/</link><description>关于博主</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Tue, 24 Dec 2024 14:49:39 +0800</lastBuildDate><atom:link href="https://agou-ops.cn/myBlog-2/index.xml" rel="self" type="application/rss+xml"/><item><title>解决VPS频繁Google人机验证（IP被ban）</title><link>https://agou-ops.cn/myBlog-2/post/%E8%A7%A3%E5%86%B3vps%E9%A2%91%E7%B9%81google%E4%BA%BA%E6%9C%BA%E9%AA%8C%E8%AF%81ip%E8%A2%AB%E5%A2%99/</link><pubDate>Thu, 02 Dec 2021 08:50:05 +0800</pubDate><author>作者</author><guid>https://agou-ops.cn/myBlog-2/post/%E8%A7%A3%E5%86%B3vps%E9%A2%91%E7%B9%81google%E4%BA%BA%E6%9C%BA%E9%AA%8C%E8%AF%81ip%E8%A2%AB%E5%A2%99/</guid><description><![CDATA[<p>前两天入手了<code>RackNerd</code>的一台VPS，选的区域是<code>华盛顿西雅图</code>，搭建好magic上网之后，访问Google老是跳人机验证，非常频繁，用起来特别烦人（问tg群里大哥说好像除了<code>洛杉矶</code>区域外基本都跳Google人机验证），都有种想换搜索引擎的冲动。但是本着要解决问题和爱折腾的态度，还是尝试解决一下吧。</p>
<p></p>
<p>:warning: 以下部分内容来源于网络，仅做个人备份学习使用。</p>]]></description></item><item><title>使用capsule管理k8s多租户（tenants）</title><link>https://agou-ops.cn/myBlog-2/post/%E4%BD%BF%E7%94%A8capsule%E7%AE%A1%E7%90%86k8s%E5%A4%9A%E7%A7%9F%E6%88%B7tenants/</link><pubDate>Tue, 24 Dec 2024 14:49:39 +0800</pubDate><author>作者</author><guid>https://agou-ops.cn/myBlog-2/post/%E4%BD%BF%E7%94%A8capsule%E7%AE%A1%E7%90%86k8s%E5%A4%9A%E7%A7%9F%E6%88%B7tenants/</guid><description><![CDATA[<p></p>
<blockquote>
<p><strong>Capsule</strong> implements a multi-tenant and policy-based environment in your Kubernetes cluster. It is designed as a micro-services-based ecosystem with the minimalist approach, leveraging only on upstream Kubernetes.</p>
<p>官方文档地址：<a href="https://capsule.clastix.io/" target="_blank" rel="noopener noreffer">https://capsule.clastix.io/</a></p>
</blockquote>]]></description></item><item><title>使用k8s CRI的checkpoint实现容器快照功能</title><link>https://agou-ops.cn/myBlog-2/post/%E4%BD%BF%E7%94%A8k8s%E5%AE%B9%E5%99%A8checkpoint%E5%AE%9E%E7%8E%B0%E5%BF%AB%E7%85%A7%E5%8A%9F%E8%83%BD/</link><pubDate>Thu, 07 Nov 2024 09:57:55 +0800</pubDate><author>作者</author><guid>https://agou-ops.cn/myBlog-2/post/%E4%BD%BF%E7%94%A8k8s%E5%AE%B9%E5%99%A8checkpoint%E5%AE%9E%E7%8E%B0%E5%BF%AB%E7%85%A7%E5%8A%9F%E8%83%BD/</guid><description><![CDATA[<blockquote>
<p>Kubernetes v1.25 引入了<a href="https://kubernetes.io/docs/reference/node/kubelet-checkpoint-api/" target="_blank" rel="noopener noreffer">Container Checkpointing API 作为 alpha 功能</a>，并<a href="https://kubernetes.io/docs/reference/node/kubelet-checkpoint-api/" target="_blank" rel="noopener noreffer">在 Kubernetes v1.30 中达到了 beta 版</a>。这提供了一种备份和恢复 Pod 中运行的容器而无需停止它们的方法。此功能主要针对安全和取证分析，但任何 Kubernetes 用户都可以利用一般备份和恢复功能。</p>
</blockquote>
<p><code>checkpointing</code>是一种确保应用程序可以从故障中恢复并维持其状态的技术。它捕获正在运行的进程的状态，包括其内存、文件描述符和其他元数据。此信息存储为检查点，稍后可用于从同一时间点恢复进程，从而实现从故障或主机之间迁移的无缝恢复，<strong>通俗来说就是容器快照功能</strong>。</p>]]></description></item><item><title>K8s多集群管理 - Liqo篇</title><link>https://agou-ops.cn/myBlog-2/post/k8s%E5%A4%9A%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86-liqo%E7%AF%87/</link><pubDate>Fri, 01 Nov 2024 10:26:47 +0800</pubDate><author>作者</author><guid>https://agou-ops.cn/myBlog-2/post/k8s%E5%A4%9A%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86-liqo%E7%AF%87/</guid><description>&lt;blockquote>
&lt;p>Liqo 是一个多集群管理平台，可以实现跨 Kubernetes 集群的动态资源调度。
Liqo 允许在远程集群上无缝运行 Pod，而无需对 Kubernetes 和应用程序进行任何修改。有了 Liqo，就可以将 Kubernetes 集群的控制平面扩展到集群的边界，将整个远程集群映射成一个虚拟本地节点，从而可以实现原生的多集群。&lt;/p>
&lt;/blockquote></description></item><item><title>使用Tailsclae VPN访问k8s集群服务（via K8s Operator）</title><link>https://agou-ops.cn/myBlog-2/post/%E4%BD%BF%E7%94%A8tailsclae-vpn%E8%AE%BF%E9%97%AEk8s%E9%9B%86%E7%BE%A4%E6%9C%8D%E5%8A%A1via-k8s-operator/</link><pubDate>Fri, 18 Oct 2024 09:12:26 +0800</pubDate><author>作者</author><guid>https://agou-ops.cn/myBlog-2/post/%E4%BD%BF%E7%94%A8tailsclae-vpn%E8%AE%BF%E9%97%AEk8s%E9%9B%86%E7%BE%A4%E6%9C%8D%E5%8A%A1via-k8s-operator/</guid><description><![CDATA[<blockquote>
<p><a href="https://tailscale.com/kb/1236/kubernetes-operator" target="_blank" rel="noopener noreffer">Tailscale Kubernetes operator</a></p>
<ul>
<li>将 Kubernetes 集群中的<a href="https://kubernetes.io/docs/concepts/services-networking/service" target="_blank" rel="noopener noreffer">服务</a>公开到 Tailscale 网络（称为 tailnet）</li>
<li>通过 API 服务器代理安全连接到<a href="https://kubernetes.io/docs/concepts/overview/components/#kube-apiserver" target="_blank" rel="noopener noreffer">Kubernetes 控制平面 (kube-apiserver)</a> ，无论是否进行身份验证</li>
<li>从 Kubernetes 集群到Egress上的外部服务的出口</li>
</ul>
</blockquote>
<p>Kubernetes Operator 目前<a href="https://tailscale.com/kb/1167/release-stages#beta" target="_blank" rel="noopener noreffer">处于测试阶段</a>。</p>]]></description></item><item><title>K8s Operator之controller Tools学习笔记</title><link>https://agou-ops.cn/myBlog-2/post/k8s-operator%E4%B9%8Bcontroller-tools%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link><pubDate>Thu, 12 Sep 2024 16:07:54 +0800</pubDate><author>作者</author><guid>https://agou-ops.cn/myBlog-2/post/k8s-operator%E4%B9%8Bcontroller-tools%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid><description><![CDATA[<blockquote>
<p>controller-tools是一个由 Kubernetes 社区维护的项目，用于简化 Kubernetes 控制器的开发。其中提供了一组工具来生成和更新 Kubernetes API 对象的代码，以及构建自定义控制器所需的代码框架。</p>
<p>仓库地址：<a href="https://github.com/kubernetes-sigs/controller-tools" target="_blank" rel="noopener noreffer">GitHub - kubernetes-sigs/controller-tools: Tools to use with the controller-runtime libraries</a></p>
</blockquote>]]></description></item><item><title>K8s中使用traefik（基础）</title><link>https://agou-ops.cn/myBlog-2/post/k8s%E4%B8%AD%E4%BD%BF%E7%94%A8traefik/</link><pubDate>Thu, 21 Sep 2023 14:30:17 +0800</pubDate><author>作者</author><guid>https://agou-ops.cn/myBlog-2/post/k8s%E4%B8%AD%E4%BD%BF%E7%94%A8traefik/</guid><description><![CDATA[<h2 id="简介">简介</h2>
<blockquote>
<p>Traefik是一个为了让部署微服务更加便捷而诞生的现代HTTP反向代理、负载均衡工具。它支持多种后台 (Docker, Swarm, Kubernetes, Marathon, Mesos, Consul, Etcd, Zookeeper, BoltDB, Rest API, file…) 来自动化、动态的应用它的配置文件设置。</p>
</blockquote>
<p>核心概念：
当启动Traefik时，需要定义<code>entrypoints</code>，然后通过entrypoints的路由来分析传入的请求，来查看他们是否是一组规则匹配，如果匹配，则路由可能将请求通过一系列的转换过来在发送到服务上去。</p>
<ul>
<li><code>Providers</code>用来自动发现平台上的服务，可以是编排工具、容器引擎</li>
<li><code>Entrypoints</code>监听传入的流量，是网络的入口点，定义了接受请求的端口(HTTP或者TCP)</li>
<li><code>Routers</code>分析请求(host,path,headers,SSL等)，负责将传入的请求连接到可以处理这些请求的服务上去</li>
<li><code>Service</code>将请求转发给应用，负责配置如何最终将处理传入请求的实际服务</li>
<li><code>Middlewares</code>中间件，用来修改请求或者根据请求来做出判断，中间件被附件到路由上，是一种在请求发送到服务之前调整请求的一种方法</li>
</ul>]]></description></item><item><title>使用cert-manager颁发自签证书</title><link>https://agou-ops.cn/myBlog-2/post/cert-manager%E9%A2%81%E5%8F%91%E8%87%AA%E7%AD%BE%E8%AF%81%E4%B9%A6/</link><pubDate>Tue, 19 Sep 2023 14:50:30 +0800</pubDate><author>作者</author><guid>https://agou-ops.cn/myBlog-2/post/cert-manager%E9%A2%81%E5%8F%91%E8%87%AA%E7%AD%BE%E8%AF%81%E4%B9%A6/</guid><description><![CDATA[<h2 id="cert-manager简介">cert-manager简介</h2>
<blockquote>
<p>cert-manager 是一个云原生证书管理开源项目，用于在 Kubernetes 集群中自动管理和颁发来自各种颁发源的 TLS 证书，它可以从各种受支持的来源颁发证书，包括 <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreffer">Let’s Encrypt</a>、<a href="https://www.vaultproject.io/" target="_blank" rel="noopener noreffer">HashiCorp Vault</a>和<a href="https://www.venafi.com/" target="_blank" rel="noopener noreffer">Venafi</a>以及私有 PKI，它将确保证书定期有效和更新，并在到期前的适当时间尝试更新证书。</p>
</blockquote>
<h2 id="k8s集群中安装cert-manager">k8s集群中安装cert-manager</h2>
<p>参考：<a href="https://cert-manager.io/docs/installation/" target="_blank" rel="noopener noreffer">https://cert-manager.io/docs/installation/</a></p>
<p>推荐使用helm chart进行安装：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">helm repo add jetstack https://charts.jetstack.io
helm repo update
kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.0/cert-manager.crds.yaml
helm install <span class="se">\
</span><span class="se"></span>  cert-manager jetstack/cert-manager <span class="se">\
</span><span class="se"></span>  --namespace cert-manager <span class="se">\
</span><span class="se"></span>  --create-namespace <span class="se">\
</span><span class="se"></span>  --version v1.13.0 <span class="se">\
</span><span class="se"></span>  <span class="c1"># --set installCRDs=true</span>
</code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>K8s中部署Apollo配置中心</title><link>https://agou-ops.cn/myBlog-2/post/k8s%E4%B8%AD%E9%83%A8%E7%BD%B2apollo%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/</link><pubDate>Mon, 11 Sep 2023 14:23:18 +0800</pubDate><author>作者</author><guid>https://agou-ops.cn/myBlog-2/post/k8s%E4%B8%AD%E9%83%A8%E7%BD%B2apollo%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/</guid><description><![CDATA[<h2 id="简介">简介</h2>
<blockquote>
<p>Apollo（阿波罗）是一款可靠的分布式配置管理中心，诞生于携程框架研发部，能够集中化管理应用不同环境、不同集群的配置，配置修改后能够实时推送到应用端，并且具备规范的权限、流程治理等特性，适用于微服务配置管理场景。</p>
<p>Apollo支持4个维度管理Key-Value格式的配置：</p>
<ol>
<li>application (应用)</li>
<li>environment (环境)</li>
<li>cluster (集群)</li>
<li>namespace (命名空间)</li>
</ol>
<p>同时，Apollo基于开源模式开发，开源地址：https://github.com/ctripcorp/apollo</p>
</blockquote>]]></description></item><item><title>Debian12二进制安装k8s v1.25.12</title><link>https://agou-ops.cn/myBlog-2/post/k8s-debian12%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E8%A3%85/</link><pubDate>Sun, 27 Aug 2023 10:33:38 +0800</pubDate><author>作者</author><guid>https://agou-ops.cn/myBlog-2/post/k8s-debian12%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E8%A3%85/</guid><description><![CDATA[<p>篇幅过长，为了更好的阅读体验可以前往<a href="https://docs.agou-ops.cn/docs/CloudNative/k8s/Installation/k8s%20Debian12%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreffer">我的文档-k8s Debian12 二进制安装</a> 或者我的<a href="https://agou-ops.cn/myBlog-2/post/k8s-debian12%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E8%A3%85/" target="_blank" rel="noopener noreffer">备用博客地址</a> .</p>
<h2 id="一预先准备">一、预先准备</h2>
<h3 id="11-服务器角色">1.1 服务器角色</h3>
<p>环境信息：</p>
<ul>
<li>k8s版本：v1.25.12</li>
<li>Debian12(bookworm)：内核6.1.0-9-amd64</li>
</ul>
<table>
<thead>
<tr>
<th>角色</th>
<th>IP</th>
<th>组件列表</th>
</tr>
</thead>
<tbody>
<tr>
<td>master</td>
<td>172.19.82.157</td>
<td>kube-apiserver、kube-controller-manage、kube-scheduler、kubelet、kube-proxy、etcd、containerd</td>
</tr>
<tr>
<td>node01</td>
<td>172.19.82.158</td>
<td>kubelet、kube-proxy、containerd、etcd</td>
</tr>
<tr>
<td>node02</td>
<td>172.19.82.159</td>
<td>kubelet、kube-proxy、containerd、etcd</td>
</tr>
</tbody>
</table>]]></description></item></channel></rss>